
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Comparing the publications volume of cities in Europe &#8212; Dimensions API Lab 0.1 documentation</title>
    <link rel="stylesheet" href="../../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/css/custom.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">Dimensions API Lab 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Comparing-the-publications-volume-of-cities-in-Europe">
<h1>Comparing the publications volume of cities in Europe<a class="headerlink" href="#Comparing-the-publications-volume-of-cities-in-Europe" title="Permalink to this headline">¶</a></h1>
<p>This notebook shows how to use the <a class="reference external" href="https://www.dimensions.ai/dimensions-apis/">Dimensions Analytics API</a> to measure the distribution of overall number of publications per European cities. For the purpose of this exercise, we will look at a specific year i.e. 2018.</p>
<p>This data will allow us to create a nice-looking map where cities producing more research can be identified visually.</p>
<blockquote>
<div><p><strong>Customize this notebook:</strong> simply change the geographical area and time-span to adapt this analysis to your needs!</p>
</div></blockquote>
<div class="section" id="Prerequisites">
<h2>Prerequisites<a class="headerlink" href="#Prerequisites" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># data analysis libraries</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="c1"># Dimensions API query helper</span>
<span class="kn">import</span> <span class="nn">dimcli</span>
<span class="n">dimcli</span><span class="o">.</span><span class="n">login</span><span class="p">()</span><span class="n">dsl</span> <span class="o">=</span> <span class="n">dimcli</span><span class="o">.</span><span class="n">Dsl</span><span class="p">()</span>
<span class="c1">#</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DimCli v0.4.3 - Succesfully connected to &lt;https://app.dimensions.ai&gt;
</pre></div></div>
</div>
<div class="section" id="1.-Getting-the-publications-data-from-Dimensions">
<h3>1. Getting the publications data from Dimensions<a class="headerlink" href="#1.-Getting-the-publications-data-from-Dimensions" title="Permalink to this headline">¶</a></h3>
<p>Dimensions DSL API can return a maximim of 1000 results per call, so in order to get the data we are interested in we need to break down the queries into smaller components.</p>
<p>We can do so by creating a separate query for each EU country, for a full year, and extract all the cities information from it.</p>
<p>This is what this query would look like:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">dsl_query</span>
search publications
where type=&quot;article&quot; and year=&quot;2018&quot; and research_org_countries in [&quot;GB&quot;]
return research_org_cities limit 1000
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Tot Publications:  208597
Returned Research_org_cities: 1000
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;dimcli.Result object #4585020608: [(&#39;research_org_cities&#39;, 1000), (&#39;_stats&#39;, 1)]&gt;
</pre></div>
</div>
</div>
<p>In order to take a peek at the data let’s put it into a pandas frame</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="s1">&#39;research_org_cities&#39;</span><span class="p">]</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>id</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63893</td>
      <td>2643743</td>
      <td>London</td>
    </tr>
    <tr>
      <th>1</th>
      <td>16173</td>
      <td>2653941</td>
      <td>Cambridge</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16073</td>
      <td>2640729</td>
      <td>Oxford</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10695</td>
      <td>2643123</td>
      <td>Manchester</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10403</td>
      <td>2650225</td>
      <td>Edinburgh</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>In essence, we want to run the query above for all countries in the EU, then collate the data into a single table.</p>
<p>First, let’s define the list of countries we need (PS: country codes are based on geonames, see also <a class="reference external" href="https://www.geonames.org/countries/">https://www.geonames.org/countries/</a>)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">europe_countries</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AD&quot;</span><span class="p">,</span><span class="s2">&quot;AL&quot;</span><span class="p">,</span><span class="s2">&quot;AT&quot;</span><span class="p">,</span><span class="s2">&quot;AX&quot;</span><span class="p">,</span><span class="s2">&quot;BA&quot;</span><span class="p">,</span><span class="s2">&quot;BE&quot;</span><span class="p">,</span><span class="s2">&quot;BG&quot;</span><span class="p">,</span><span class="s2">&quot;BY&quot;</span><span class="p">,</span><span class="s2">&quot;CH&quot;</span><span class="p">,</span><span class="s2">&quot;CZ&quot;</span><span class="p">,</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span><span class="s2">&quot;DK&quot;</span><span class="p">,</span><span class="s2">&quot;EE&quot;</span><span class="p">,</span><span class="s2">&quot;ES&quot;</span><span class="p">,</span><span class="s2">&quot;FI&quot;</span><span class="p">,</span><span class="s2">&quot;FO&quot;</span><span class="p">,</span><span class="s2">&quot;FR&quot;</span><span class="p">,</span><span class="s2">&quot;GB&quot;</span><span class="p">,</span><span class="s2">&quot;GG&quot;</span><span class="p">,</span><span class="s2">&quot;GI&quot;</span><span class="p">,</span><span class="s2">&quot;GR&quot;</span><span class="p">,</span><span class="s2">&quot;HR&quot;</span><span class="p">,</span><span class="s2">&quot;HU&quot;</span><span class="p">,</span><span class="s2">&quot;IE&quot;</span><span class="p">,</span><span class="s2">&quot;IM&quot;</span><span class="p">,</span><span class="s2">&quot;IS&quot;</span><span class="p">,</span><span class="s2">&quot;IT&quot;</span><span class="p">,</span><span class="s2">&quot;JE&quot;</span><span class="p">,</span><span class="s2">&quot;LI&quot;</span><span class="p">,</span><span class="s2">&quot;LT&quot;</span><span class="p">,</span><span class="s2">&quot;LU&quot;</span><span class="p">,</span><span class="s2">&quot;LV&quot;</span><span class="p">,</span><span class="s2">&quot;MC&quot;</span><span class="p">,</span><span class="s2">&quot;MD&quot;</span><span class="p">,</span><span class="s2">&quot;ME&quot;</span><span class="p">,</span><span class="s2">&quot;MK&quot;</span><span class="p">,</span><span class="s2">&quot;MT&quot;</span><span class="p">,</span><span class="s2">&quot;NL&quot;</span><span class="p">,</span><span class="s2">&quot;NO&quot;</span><span class="p">,</span><span class="s2">&quot;PL&quot;</span><span class="p">,</span><span class="s2">&quot;PT&quot;</span><span class="p">,</span><span class="s2">&quot;RO&quot;</span><span class="p">,</span><span class="s2">&quot;RS&quot;</span><span class="p">,</span><span class="s2">&quot;RU&quot;</span><span class="p">,</span><span class="s2">&quot;SE&quot;</span><span class="p">,</span><span class="s2">&quot;SI&quot;</span><span class="p">,</span><span class="s2">&quot;SJ&quot;</span><span class="p">,</span><span class="s2">&quot;SK&quot;</span><span class="p">,</span><span class="s2">&quot;SM&quot;</span><span class="p">,</span><span class="s2">&quot;UA&quot;</span><span class="p">,</span><span class="s2">&quot;VA&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Now we can set up a parametrized query loop as follows</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">q_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;search publications</span>
<span class="s2">where type=&quot;article&quot; and date=&quot;2018&quot; and research_org_countries in [&quot;</span><span class="si">%s</span><span class="s2">&quot;]</span>
<span class="s2">return research_org_cities limit 1000&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df_master</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">europe_countries</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">q_template</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">dsl</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">show_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;research_org_cities&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">df_master</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">df_master</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df_temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">df_master</span> <span class="o">=</span> <span class="n">df_master</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_temp</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Country:&quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s2">&quot; - Master Dataset Rows:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_master</span><span class="p">))</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;FINISHED!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Country: AD Master Dataset Rows: 0 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: AL Master Dataset Rows: 6 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: AT Master Dataset Rows: 177 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: AX Master Dataset Rows: 177 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: BA Master Dataset Rows: 182 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: BE Master Dataset Rows: 482 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: BG Master Dataset Rows: 510 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: BY Master Dataset Rows: 581 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: CH Master Dataset Rows: 956 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: CZ Master Dataset Rows: 1093 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: DE Master Dataset Rows: 1682 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: DK Master Dataset Rows: 1970 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: EE Master Dataset Rows: 1977 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: ES Master Dataset Rows: 2411 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: FI Master Dataset Rows: 2563 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: FO Master Dataset Rows: 2563 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: FR Master Dataset Rows: 3159 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: GB Master Dataset Rows: 3860 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: GG Master Dataset Rows: 3860 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: GI Master Dataset Rows: 3860 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: GR Master Dataset Rows: 4029 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: HR Master Dataset Rows: 4039 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: HU Master Dataset Rows: 4094 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: IE Master Dataset Rows: 4166 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: IM Master Dataset Rows: 4166 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: IS Master Dataset Rows: 4178 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: IT Master Dataset Rows: 4672 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: JE Master Dataset Rows: 4672 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: LI Master Dataset Rows: 4672 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: LT Master Dataset Rows: 4674 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: LU Master Dataset Rows: 4676 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: LV Master Dataset Rows: 4677 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: MC Master Dataset Rows: 4680 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: MD Master Dataset Rows: 4682 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: ME Master Dataset Rows: 4683 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: MK Master Dataset Rows: 4683 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: MT Master Dataset Rows: 4754 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: NL Master Dataset Rows: 5177 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: NO Master Dataset Rows: 5381 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: PL Master Dataset Rows: 5584 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: PT Master Dataset Rows: 5803 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: RO Master Dataset Rows: 5897 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: RS Master Dataset Rows: 5948 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: RU Master Dataset Rows: 6169 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: SE Master Dataset Rows: 6455 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: SI Master Dataset Rows: 6543 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: SJ Master Dataset Rows: 6543 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: SK Master Dataset Rows: 6619 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: SM Master Dataset Rows: 6619 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: UA Master Dataset Rows: 6663 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Country: VA Master Dataset Rows: 6663 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
FINISHED!
</pre></div></div>
</div>
<p>That’s it! We extracted all the publications per city data from Dimensions.</p>
<p>Let’s save the raw data as a CSV file.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df_master</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;tmp/raw_cities_data_dimensions_2019-04-23.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="2.-Cleaning-the-data-by-removing-duplicates">
<h3>2. Cleaning the data by removing duplicates<a class="headerlink" href="#2.-Cleaning-the-data-by-removing-duplicates" title="Permalink to this headline">¶</a></h3>
<p>Next up, we want to combine the raw data so that we have only one entry per city.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df_master_merged</span> <span class="o">=</span> <span class="n">df_master</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">aggfunc</span><span class="o">=</span><span class="nb">sum</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># fix column names (https://stackoverflow.com/questions/33290374/pandas-pivot-table-column-names)</span>
<span class="n">df_master_merged</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Let’s take a quick look at what we have now. Also, save this intermediary step as a different CSV.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">len</span><span class="p">(</span><span class="n">df_master_merged</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>1466
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df_master_merged</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;tmp/merged_cities_data_2019-04-23.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df_master_merged</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/notebooks_-notebooks-2-check_2-sample-applications_Publications-for-European-Cities_Publications-distribution-for-European-Cities_21_0.png" src="../../../../_images/notebooks_-notebooks-2-check_2-sample-applications_Publications-for-European-Cities_Publications-distribution-for-European-Cities_21_0.png" />
</div>
</div>
</div>
<div class="section" id="3.-Enriching-the-cities-data-with-geonames.org-lat/long">
<h3>3. Enriching the cities data with geonames.org lat/long<a class="headerlink" href="#3.-Enriching-the-cities-data-with-geonames.org-lat/long" title="Permalink to this headline">¶</a></h3>
<p>In this section we want to take all cities information and enhance it by adding geocoordinates. These will become handy later on if we want to plot the data on a map.</p>
<p>We will use the free service <a class="reference external" href="http://www.geonames.org/export/web-services.html">geonames.org</a> for this. PS you must create a free account/username in order to use it (see also <a class="reference external" href="http://www.geonames.org/export/credits.html">http://www.geonames.org/export/credits.html</a>).</p>
<p>Geonames information will also let us do more data clean up: due to co-author information, the cities list we currenlty have contains some non-EU places (e.g. New York, because authors from NY happened to be co-authoring papers with EU authors). These values can be easily filtered out once we the cities information from Dimensions is enriched with country codes (from geonames.org).</p>
<p>First let’s read the CSV created in the previous section and generate a pandas dataframe from it.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;tmp/merged_cities_data_2019-04-23.csv&quot;</span><span class="p">)</span>
<span class="n">df1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>id</th>
      <th>name</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2643743</td>
      <td>London</td>
      <td>468</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2988507</td>
      <td>Paris</td>
      <td>293</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3128760</td>
      <td>Barcelona</td>
      <td>176</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2759794</td>
      <td>Amsterdam</td>
      <td>172</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>3117735</td>
      <td>Madrid</td>
      <td>171</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Drop the first column and rename the second one</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df1</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df1</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;geonamesId&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">]</span>
<span class="n">df1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geonamesId</th>
      <th>name</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2643743</td>
      <td>London</td>
      <td>468</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2988507</td>
      <td>Paris</td>
      <td>293</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3128760</td>
      <td>Barcelona</td>
      <td>176</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2759794</td>
      <td>Amsterdam</td>
      <td>172</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3117735</td>
      <td>Madrid</td>
      <td>171</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Now let’s set up a function that queries geonames.org based on the locations IDs we have.</p>
<p>PS geonames API has a hourly limit of 1000 credits/requests, hence we will slow down the execution using <code class="docutils literal notranslate"><span class="pre">time.sleep()</span></code> later on.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="n">geonameuser</span> <span class="o">=</span> <span class="s2">&quot;YOUR_USERNAME_HERE&quot;</span>  <span class="c1">############## REPLACE AS NEEDED #################</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;http://api.geonames.org/hierarchyJSON?geonameId=</span><span class="si">%s</span><span class="s2">&amp;username=</span><span class="si">%s</span><span class="s2">&quot;</span>
<span class="c1">#</span>

<span class="c1"># eg http://api.geonames.org/hierarchyJSON?geonameId=2643743&amp;username=mpasin</span>
<span class="k">def</span> <span class="nf">open_geonames</span><span class="p">(</span><span class="n">_id</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">_id</span><span class="p">),</span> <span class="n">geonameuser</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">geonames_details</span><span class="p">(</span><span class="n">_id</span><span class="p">):</span>
    <span class="n">_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">_id</span><span class="p">)</span> <span class="c1"># make sure it&#39;s a number</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">open_geonames</span><span class="p">(</span><span class="n">_id</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;geonames&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;geonameId&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">_id</span><span class="p">:</span>
                <span class="n">lat</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span>
                <span class="n">lng</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;lng&#39;</span><span class="p">]</span>
                <span class="n">countryCode</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;countryCode&#39;</span><span class="p">]</span>
                <span class="n">countryName</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;countryName&#39;</span><span class="p">]</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">lat</span><span class="p">,</span> <span class="n">lng</span><span class="p">,</span> <span class="n">countryCode</span><span class="p">,</span> <span class="n">countryName</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error parsing JSON: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># EG</span>
<span class="n">geonames_details</span><span class="p">(</span><span class="mi">3522210</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[&#39;20.11697&#39;, &#39;-98.73329&#39;, &#39;MX&#39;, &#39;Mexico&#39;]
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">In order to prevent losing data is the geonames API returns an error, we store the cities data a dict which we can save as JSON.</div>
<div class="line">This can be updated with geonames infos incrementally, using separate runs (if necessary).</div>
</div>
<p>We use a list of dictionaries so to preserve the original order.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">temp</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">temp</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;geonamesId&#39;</span><span class="p">]:</span>
    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="kc">None</span><span class="p">})</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;tmp/geonames_temp.json&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">temp</span>  <span class="p">,</span> <span class="n">outfile</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Read the data back in for iteration</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;tmp/geonames_temp.json&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
    <span class="n">tempfiledata</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Iterate and enrich the dict with the geonames details.</p>
<p>If geonames API fails, the value for a place ID remains null.</p>
<p>The iteration only takes null-place info elements, so we can rerun this cell as many times as needed to get data for all places.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">ddict</span> <span class="ow">in</span> <span class="n">tempfiledata</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]:</span>
    <span class="n">_id</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">ddict</span><span class="p">))</span> <span class="c1"># get first element</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ddict</span><span class="p">[</span><span class="n">_id</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="s2">&quot;...&quot;</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">geonames_details</span><span class="p">(</span><span class="n">_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
            <span class="n">tempfiledata</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="n">counter</span><span class="p">][</span><span class="n">_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>
        <span class="c1"># print(&quot;skipping&quot;, counter)</span>
    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># now save to file</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;tmp/geonames_temp.json&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">tempfiledata</span><span class="p">,</span> <span class="n">outfile</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DONE: data saved&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1435 ...
DONE: data saved
</pre></div></div>
</div>
<p>Finally, add the geonames data to the original data frame.</p>
<p>We can do this by creating a list for each of the new columns, making sure they have the exact same number of elements of the original data frame.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">lats</span><span class="p">,</span> <span class="n">longs</span><span class="p">,</span> <span class="n">countryCodes</span><span class="p">,</span> <span class="n">countryNames</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tempfiledata</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]:</span>
    <span class="n">_id</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="c1"># get first element</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">[</span><span class="n">_id</span><span class="p">]:</span>
        <span class="n">lats</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">])</span>
        <span class="n">longs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">])</span>
        <span class="n">countryCodes</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">])</span>
        <span class="n">countryNames</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">_id</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">longs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">_id</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">countryCodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">_id</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">countryNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">_id</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>

<span class="nb">len</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">lats</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">longs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">countryCodes</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">countryNames</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>True
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># when finished, update the dataframe and save</span>
<span class="n">df1</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lats</span>
<span class="n">df1</span><span class="p">[</span><span class="s1">&#39;lng&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">longs</span>
<span class="n">df1</span><span class="p">[</span><span class="s1">&#39;countryCode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">countryCodes</span>
<span class="n">df1</span><span class="p">[</span><span class="s1">&#39;countryName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">countryNames</span>
<span class="n">df1</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;tmp/enriched_cities_data_2019-04-23.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Finally, we can remove non-EU cities from the data table</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;tmp/enriched_cities_data_2019-04-23.csv&quot;</span><span class="p">)</span>
<span class="n">europe_countries</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AD&quot;</span><span class="p">,</span><span class="s2">&quot;AL&quot;</span><span class="p">,</span><span class="s2">&quot;AT&quot;</span><span class="p">,</span><span class="s2">&quot;AX&quot;</span><span class="p">,</span><span class="s2">&quot;BA&quot;</span><span class="p">,</span><span class="s2">&quot;BE&quot;</span><span class="p">,</span><span class="s2">&quot;BG&quot;</span><span class="p">,</span><span class="s2">&quot;BY&quot;</span><span class="p">,</span><span class="s2">&quot;CH&quot;</span><span class="p">,</span><span class="s2">&quot;CZ&quot;</span><span class="p">,</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span><span class="s2">&quot;DK&quot;</span><span class="p">,</span><span class="s2">&quot;EE&quot;</span><span class="p">,</span><span class="s2">&quot;ES&quot;</span><span class="p">,</span><span class="s2">&quot;FI&quot;</span><span class="p">,</span><span class="s2">&quot;FO&quot;</span><span class="p">,</span><span class="s2">&quot;FR&quot;</span><span class="p">,</span><span class="s2">&quot;GB&quot;</span><span class="p">,</span><span class="s2">&quot;GG&quot;</span><span class="p">,</span><span class="s2">&quot;GI&quot;</span><span class="p">,</span><span class="s2">&quot;GR&quot;</span><span class="p">,</span><span class="s2">&quot;HR&quot;</span><span class="p">,</span><span class="s2">&quot;HU&quot;</span><span class="p">,</span><span class="s2">&quot;IE&quot;</span><span class="p">,</span><span class="s2">&quot;IM&quot;</span><span class="p">,</span><span class="s2">&quot;IS&quot;</span><span class="p">,</span><span class="s2">&quot;IT&quot;</span><span class="p">,</span><span class="s2">&quot;JE&quot;</span><span class="p">,</span><span class="s2">&quot;LI&quot;</span><span class="p">,</span><span class="s2">&quot;LT&quot;</span><span class="p">,</span><span class="s2">&quot;LU&quot;</span><span class="p">,</span><span class="s2">&quot;LV&quot;</span><span class="p">,</span><span class="s2">&quot;MC&quot;</span><span class="p">,</span><span class="s2">&quot;MD&quot;</span><span class="p">,</span><span class="s2">&quot;ME&quot;</span><span class="p">,</span><span class="s2">&quot;MK&quot;</span><span class="p">,</span><span class="s2">&quot;MT&quot;</span><span class="p">,</span><span class="s2">&quot;NL&quot;</span><span class="p">,</span><span class="s2">&quot;NO&quot;</span><span class="p">,</span><span class="s2">&quot;PL&quot;</span><span class="p">,</span><span class="s2">&quot;PT&quot;</span><span class="p">,</span><span class="s2">&quot;RO&quot;</span><span class="p">,</span><span class="s2">&quot;RS&quot;</span><span class="p">,</span><span class="s2">&quot;RU&quot;</span><span class="p">,</span><span class="s2">&quot;SE&quot;</span><span class="p">,</span><span class="s2">&quot;SI&quot;</span><span class="p">,</span><span class="s2">&quot;SJ&quot;</span><span class="p">,</span><span class="s2">&quot;SK&quot;</span><span class="p">,</span><span class="s2">&quot;SM&quot;</span><span class="p">,</span><span class="s2">&quot;UA&quot;</span><span class="p">,</span><span class="s2">&quot;VA&quot;</span><span class="p">]</span>

<span class="n">to_drop</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;countryCode&#39;</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">y</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">europe_countries</span><span class="p">:</span>
        <span class="n">to_drop</span> <span class="o">+=</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>

<span class="n">df1</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">to_drop</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>


</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>geonamesId</th>
      <th>name</th>
      <th>count</th>
      <th>lat</th>
      <th>lng</th>
      <th>countryCode</th>
      <th>countryName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2643743</td>
      <td>London</td>
      <td>468</td>
      <td>51.50853</td>
      <td>-0.12574</td>
      <td>GB</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2988507</td>
      <td>Paris</td>
      <td>293</td>
      <td>48.85341</td>
      <td>2.3488</td>
      <td>FR</td>
      <td>France</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3128760</td>
      <td>Barcelona</td>
      <td>176</td>
      <td>41.38879</td>
      <td>2.15899</td>
      <td>ES</td>
      <td>Spain</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2759794</td>
      <td>Amsterdam</td>
      <td>172</td>
      <td>52.37403</td>
      <td>4.88969</td>
      <td>NL</td>
      <td>Netherlands</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>3117735</td>
      <td>Madrid</td>
      <td>171</td>
      <td>40.4165</td>
      <td>-3.70256</td>
      <td>ES</td>
      <td>Spain</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df1</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geonamesId</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>8.080000e+02</td>
      <td>808.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.627860e+06</td>
      <td>13.493812</td>
    </tr>
    <tr>
      <th>std</th>
      <td>8.137934e+05</td>
      <td>30.379793</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2.518330e+05</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.641306e+06</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.825690e+06</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>3.031248e+06</td>
      <td>13.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>6.543862e+06</td>
      <td>468.000000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>There are <strong>808</strong> cities from the EU listed now.</p>
<p>As a final step, let’s remove the first column and save the data as CSV.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df1</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df1</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;cities_data_final_2019-04-23.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>That’s it. This is the final dataset, which includes only EU cities infos.</p>
</div>
<div class="section" id="4.-Visualising-the-data">
<h3>4. Visualising the data<a class="headerlink" href="#4.-Visualising-the-data" title="Permalink to this headline">¶</a></h3>
<p>This final step is optional, but a bit of eye-candy will undoubtedly make you feel good :-)</p>
<p>We can create a nice interactive bar chart using the open source <a class="reference external" href="https://plot.ly/python/">plotly</a> library.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">plotly</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objs</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">from</span> <span class="nn">plotly.offline</span> <span class="k">import</span> <span class="n">download_plotlyjs</span><span class="p">,</span> <span class="n">init_notebook_mode</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">iplot</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plotly</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;3.8.1&#39;
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">init_notebook_mode</span><span class="p">(</span><span class="n">connected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-latest.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;cities_data_final_2019-04-23.csv&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>geonamesId</th>
      <th>name</th>
      <th>count</th>
      <th>lat</th>
      <th>lng</th>
      <th>countryCode</th>
      <th>countryName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2643743</td>
      <td>London</td>
      <td>468</td>
      <td>51.50853</td>
      <td>-0.12574</td>
      <td>GB</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2988507</td>
      <td>Paris</td>
      <td>293</td>
      <td>48.85341</td>
      <td>2.34880</td>
      <td>FR</td>
      <td>France</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3128760</td>
      <td>Barcelona</td>
      <td>176</td>
      <td>41.38879</td>
      <td>2.15899</td>
      <td>ES</td>
      <td>Spain</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2759794</td>
      <td>Amsterdam</td>
      <td>172</td>
      <td>52.37403</td>
      <td>4.88969</td>
      <td>NL</td>
      <td>Netherlands</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>3117735</td>
      <td>Madrid</td>
      <td>171</td>
      <td>40.41650</td>
      <td>-3.70256</td>
      <td>ES</td>
      <td>Spain</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]],</span>
            <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]]</span>
    <span class="p">)]</span>
<span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;cities_bar.html&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;cities_bar.html&#39;
</pre></div>
</div>
</div>
<p>The file <code class="docutils literal notranslate"><span class="pre">cities_bar.html</span></code> should open automatically in the browser and it’ll let you dig into the data via a cool interactive bar chart! Have fun :-)</p>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="Want-to-learn-more?">
<h1>Want to learn more?<a class="headerlink" href="#Want-to-learn-more?" title="Permalink to this headline">¶</a></h1>
<p>Check out the <a class="reference external" href="https://digital-science.github.io/dimensions-api-lab/">Dimensions API Lab</a> website, which contains many tutorials and reusable Jupyter notebooks for scholarly data analytics.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Comparing the publications volume of cities in Europe</a><ul>
<li><a class="reference internal" href="#Prerequisites">Prerequisites</a><ul>
<li><a class="reference internal" href="#1.-Getting-the-publications-data-from-Dimensions">1. Getting the publications data from Dimensions</a></li>
<li><a class="reference internal" href="#2.-Cleaning-the-data-by-removing-duplicates">2. Cleaning the data by removing duplicates</a></li>
<li><a class="reference internal" href="#3.-Enriching-the-cities-data-with-geonames.org-lat/long">3. Enriching the cities data with geonames.org lat/long</a></li>
<li><a class="reference internal" href="#4.-Visualising-the-data">4. Visualising the data</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#Want-to-learn-more?">Want to learn more?</a></li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../../_sources/notebooks/-notebooks-2-check/2-sample-applications/Publications-for-European-Cities/Publications-distribution-for-European-Cities.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">Dimensions API Lab 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Dimensions API Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.0.1.
    </div>
  </body>
</html>